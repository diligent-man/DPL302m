in statistics originally in geostatistics kriging or kriging also known as gaussian process regression is a method of interpolation based on gaussian process governed by prior covariances
under suitable assumptions of the prior kriging gives the best linear unbiased prediction blup at unsampled locations
interpolating methods based on other criteria such as smoothness e g smoothing spline may not yield the blup
the method is widely used in the domain of spatial analysis and computer experiments
the technique is also known as wiener kolmogorov prediction after norbert wiener and andrey kolmogorov
the theoretical basis for the method was developed by the french mathematician georges matheron in based on the master s thesis of danie g
krige the pioneering plotter of distance weighted average gold grades at the witwatersrand reef complex in south africa
krige sought to estimate the most likely distribution of gold based on samples from a few boreholes
the english verb is to krige and the most common noun is kriging both are often pronounced with a hard g following an anglicized pronunciation of the name krige
the word is sometimes capitalized as kriging in the literature
though computationally intensive in its basic formulation kriging can be scaled to larger problems using various approximation methods
kriging predicts the value of a function at a given point by computing a weighted average of the known values of the function in the neighborhood of the point
the method is closely related to regression analysis
both theories derive a best linear unbiased estimator based on assumptions on covariances make use of gauss markov theorem to prove independence of the estimate and error and use very similar formulae
even so they are useful in different frameworks kriging is made for estimation of a single realization of a random field while regression models are based on multiple observations of a multivariate data set
the kriging estimation may also be seen as a spline in a reproducing kernel hilbert space with the reproducing kernel given by the covariance function
the difference with the classical kriging approach is provided by the interpretation while the spline is motivated by a minimum norm interpolation based on a hilbert space structure kriging is motivated by an expected squared prediction error based on a stochastic model
kriging with polynomial trend surfaces is mathematically identical to generalized least squares polynomial curve fitting
kriging can also be understood as a form of bayesian inference
kriging starts with a prior distribution over functions
this prior takes the form of a gaussian process
displaystyle n
samples from a function will be normally distributed where the covariance between any two samples is the covariance function or kernel of the gaussian process evaluated at the spatial location of two points
a set of values is then observed each value associated with a spatial location
now a new value can be predicted at any new spatial location by combining the gaussian prior with a gaussian likelihood function for each of the observed values
the resulting posterior distribution is also gaussian with a mean and covariance that can be simply computed from the observed values their variance and the kernel matrix derived from the prior
in geostatistical models sampled data are interpreted as the result of a random process
the fact that these models incorporate uncertainty in their conceptualization doesn t mean that the phenomenon the forest the aquifer the mineral deposit has resulted from a random process but rather it allows one to build a methodological basis for the spatial inference of quantities in unobserved locations and to quantify the uncertainty associated with the estimator
a stochastic process is in the context of this model simply a way to approach the set of data collected from the samples
the first step in geostatistical modulation is to create a random process that best describes the set of observed data
a value from location
displaystyle x
generic denomination of a set of geographic coordinates is interpreted as a realization
displaystyle z x
of the random variable
displaystyle z x
in the space
displaystyle a
where the set of samples is dispersed there are
displaystyle n
realizations of the random variables
displaystyle z x z x ldots z x n
correlated between themselves
the set of random variables constitutes a random function of which only one realization is known the set
displaystyle z x i
of observed data
with only one realization of each random variable it s theoretically impossible to determine any statistical parameter of the individual variables or the function
the proposed solution in the geostatistical formalism consists in assuming various degrees of stationarity in the random function in order to make the inference of some statistic values possible
for instance if one assumes based on the homogeneity of samples in area
displaystyle a
where the variable is distributed the hypothesis that the first moment is stationary i e
all random variables have the same mean then one is assuming that the mean can be estimated by the arithmetic mean of sampled values
the hypothesis of stationarity related to the second moment is defined in the following way the correlation between two random variables solely depends on the spatial distance between them and is independent of their location
thus if
displaystyle mathbf h x x
displaystyle mathbf h h
displaystyle c big z x z x big c big z x i z x i mathbf h big c h
displaystyle gamma big z x z x big gamma big z x i z x i mathbf h big gamma h
for simplicity we define
displaystyle c x i x j c big z x i z x j big
displaystyle gamma x i x j gamma big z x i z x j big
this hypothesis allows one to infer those two measures the variogram and the covariogram
displaystyle gamma h frac n h sum i j in n h big z x i z x j big
displaystyle c h frac n h sum i j in n h big z x i m h big big z x j m h big
where
displaystyle m h frac n h sum i j in n h z x i z x j
displaystyle n h
denotes the set of pairs of observations
displaystyle i j
such that
displaystyle x i x j h
displaystyle n h
is the number of pairs in the set in this set
displaystyle i j
displaystyle j i
denote the same element
generally an approximate distance
displaystyle h
is used implemented using a certain tolerance
spatial inference or estimation of a quantity
displaystyle z colon mathbb r n to mathbb r
at an unobserved location
displaystyle x
is calculated from a linear combination of the observed values
displaystyle z i z x i
and weights
displaystyle w i x i ldots n
displaystyle hat z x begin bmatrix w w cdots w n end bmatrix cdot begin bmatrix z z vdots z n end bmatrix sum i n w i x times z x i
the weights
displaystyle w i
are intended to summarize two extremely important procedures in a spatial inference process
reflect the structural proximity of samples to the estimation location
displaystyle x
at the same time they should have a desegregation effect in order to avoid bias caused by eventual sample clusters when calculating the weights
displaystyle w i
there are two objectives in the geostatistical formalism unbias and minimal variance of estimation
if the cloud of real values
displaystyle z x
is plotted against the estimated values
displaystyle hat z x
the criterion for global unbias intrinsic stationarity or wide sense stationarity of the field implies that the mean of the estimations must be equal to mean of the real values
the second criterion says that the mean of the squared deviations
displaystyle big hat z x z x big
must be minimal which means that when the cloud of estimated values versus the cloud real values is more disperse the estimator is more imprecise
depending on the stochastic properties of the random field and the various degrees of stationarity assumed different methods for calculating the weights can be deduced i e
different types of kriging apply
classical methods are
ordinary kriging assumes constant unknown mean only over the search neighborhood of
displaystyle x
simple kriging assumes stationarity of the first moment over the entire domain with a known mean
displaystyle e z x e z x m
where
displaystyle m
is the known mean
universal kriging assumes a general polynomial trend model such as linear trend model
displaystyle textstyle e z x sum k p beta k f k x
irfk kriging assumes
displaystyle e z x
to be an unknown polynomial in
displaystyle x
indicator kriging uses indicator functions instead of the process itself in order to estimate transition probabilities
multiple indicator kriging is a version of indicator kriging working with a family of indicators
initially mik showed considerable promise as a new method that could more accurately estimate overall global mineral deposit concentrations or grades
however these benefits have been outweighed by other inherent problems of practicality in modelling due to the inherently large block sizes used and also the lack of mining scale resolution
conditional simulation is fast becoming the accepted replacement technique in this case
disjunctive kriging is a nonlinear generalisation of kriging
log normal kriging interpolates positive data by means of logarithms
latent kriging assumes the various krigings on the latent level second stage of the nonlinear mixed effects model to produce a spatial functional prediction
this technique is useful when analyzing a spatial functional data
displaystyle y i x i s i i n
where
displaystyle y i y i y i cdots y it i top
is a time series data over
displaystyle t i
period
displaystyle x i x i x i cdots x ip top
is a vector of
displaystyle p
covariates and
displaystyle s i s i s i top
is a spatial location longitude latitude of the
displaystyle i
th subject
co kriging denotes the joint kriging of data from multiple sources with a relationship between the different data sources
co kriging is also possible in a bayesian approach
bayesian kriging departs from the optimization of unknown coefficients and hyperparameters which is understood as a maximum likelihood estimate from the bayesian perspective
instead the coefficients and hyperparameters are estimated from their expectation values an advantage of bayesian kriging is that it allows to quantify the evidence for and the uncertainty of the kriging emulator
if the emulator is employed to propagate uncertainties the quality of the kriging emulator can be assessed by comparing the emulator uncertainty to the total uncertainty see also bayesian polynomial chaos
bayesian kriging can also be mixed with co kriging the unknown value
displaystyle z x
is interpreted as a random variable located in
displaystyle x
as well as the values of neighbors samples
displaystyle z x i i ldots n
the estimator
displaystyle hat z x
is also interpreted as a random variable located in
displaystyle x
a result of the linear combination of variables
in order to deduce the kriging system for the assumptions of the model the following error committed while estimating
displaystyle z x
displaystyle x
is declared
displaystyle epsilon x hat z x z x begin bmatrix w t end bmatrix cdot begin bmatrix z x cdots z x n z x end bmatrix t sum i n w i x times z x i z x
the two quality criteria referred to previously can now be expressed in terms of the mean and variance of the new random variable
displaystyle epsilon x
lack of biassince the random function is stationary
displaystyle e z x i e z x m
the following constraint is observed
displaystyle e epsilon x leftrightarrow sum i n w i x times e z x i e z x leftrightarrow
displaystyle leftrightarrow m sum i n w i x m leftrightarrow sum i n w i x leftrightarrow mathbf t cdot w
in order to ensure that the model is unbiased the weights must sum to one
minimum variancetwo estimators can have
displaystyle e epsilon x
but the dispersion around their mean determines the difference between the quality of estimators
to find an estimator with minimum variance we need to minimize
displaystyle e epsilon x
displaystyle begin aligned operatorname var epsilon x operatorname var left begin bmatrix w t end bmatrix cdot begin bmatrix z x cdots z x n z x end bmatrix t right begin bmatrix w t end bmatrix cdot operatorname var left begin bmatrix z x cdots z x n z x end bmatrix t right cdot begin bmatrix w end bmatrix end aligned
see covariance matrix for a detailed explanation
displaystyle operatorname var epsilon x begin bmatrix w t end bmatrix cdot begin bmatrix operatorname var x i operatorname cov x i x operatorname cov x i x t operatorname var x end bmatrix cdot begin bmatrix w end bmatrix
where the literals
displaystyle left operatorname var x i operatorname var x operatorname cov x i x right
stand for
displaystyle left operatorname var left begin bmatrix z x cdots z x n end bmatrix t right operatorname var big z x big operatorname cov left begin bmatrix z x cdots z x n end bmatrix t z x right right
once defined the covariance model or variogram
displaystyle c mathbf h
displaystyle gamma mathbf h
valid in all field of analysis of
displaystyle z x
then we can write an expression for the estimation variance of any estimator in function of the covariance between the samples and the covariances between the samples and the point to estimate
displaystyle begin cases operatorname var big epsilon x big w t cdot operatorname var x i cdot w operatorname cov x i x t cdot w w t cdot operatorname cov x i x operatorname var x operatorname var big epsilon x big operatorname cov sum i sum j w i w j operatorname cov x i x j sum i w i c x i x end cases
some conclusions can be asserted from this expression
the variance of estimation
is not quantifiable to any linear estimator once the stationarity of the mean and of the spatial covariances or variograms are assumed
grows when the covariance between the samples and the point to estimate decreases
this means that when the samples are farther away from
displaystyle x
the estimation becomes worse
grows with the a priori variance
displaystyle c
of the variable
displaystyle z x
when the variable is less disperse the variance is lower in any point of the area
displaystyle a
does not depend on the values of the samples which means that the same spatial configuration with the same geometrical relations between samples and the point to estimate always reproduces the same estimation variance in any part of the area
displaystyle a
this way the variance does not measure the uncertainty of estimation produced by the local variable system of equations
displaystyle w underset mathbf t cdot w operatorname arg min left w t cdot operatorname var x i cdot w operatorname cov x i x t cdot w w t cdot operatorname cov x i x operatorname var x right
solving this optimization problem see lagrange multipliers results in the kriging system
displaystyle begin bmatrix hat w mu end bmatrix begin bmatrix operatorname var x i mathbf mathbf t end bmatrix cdot begin bmatrix operatorname cov x i x end bmatrix begin bmatrix gamma x x cdots gamma x x n vdots ddots vdots vdots gamma x n x cdots gamma x n x n cdots end bmatrix begin bmatrix gamma x x vdots gamma x n x end bmatrix
the additional parameter
displaystyle mu
is a lagrange multiplier used in the minimization of the kriging error
displaystyle sigma k x
to honor the unbiasedness condition
simple kriging is mathematically the simplest but the least general
it assumes the expectation of the random field is known and relies on a covariance function
however in most applications neither the expectation nor the covariance are known beforehand
the practical assumptions for the application of simple kriging are
wide sense stationarity of the field variance stationary
the expectation is zero everywhere
displaystyle mu x
known covariance function
displaystyle c x y operatorname cov big z x z y big
the covariance function is a crucial design choice since it stipulates the properties of the gaussian process and thereby the behaviour of the model
the covariance function encodes information about for instance smoothness and periodicity which is reflected in the estimate produced
a very common covariance function is the squared exponential which heavily favours smooth function estimates
for this reason it can produce poor estimates in many real world applications especially when the true underlying function contains discontinuities and rapid changes
system of equationsthe kriging weights of simple kriging have no unbiasedness condition and are given by the simple kriging equation system
displaystyle begin pmatrix w vdots w n end pmatrix begin pmatrix c x x cdots c x x n vdots ddots vdots c x n x cdots c x n x n end pmatrix begin pmatrix c x x vdots c x n x end pmatrix
this is analogous to a linear regression of
displaystyle z x
on the other
displaystyle z ldots z n
estimationthe interpolation by simple kriging is given by
displaystyle hat z x begin pmatrix z vdots z n end pmatrix begin pmatrix c x x cdots c x x n vdots ddots vdots c x n x cdots c x n x n end pmatrix begin pmatrix c x x vdots c x n x end pmatrix
the kriging error is given by
displaystyle operatorname var big hat z x z x big underbrace c x x operatorname var big z x big underbrace begin pmatrix c x x vdots c x n x end pmatrix begin pmatrix c x x cdots c x x n vdots ddots vdots c x n x cdots c x n x n end pmatrix begin pmatrix c x x vdots c x n x end pmatrix operatorname var big hat z x big
which leads to the generalised least squares version of the gauss markov theorem chiles delfiner p
displaystyle operatorname var big z x big operatorname var big hat z x big operatorname var big hat z x z x big
see also bayesian polynomial chaos
the kriging estimation is unbiased
displaystyle e hat z x i e z x i
the kriging estimation honors the actually observed value
displaystyle hat z x i z x i
assuming no measurement error is incurred
the kriging estimation
displaystyle hat z x
is the best linear unbiased estimator of
displaystyle z x
if the assumptions hold
however e g
cressie
as with any method if the assumptions do not hold kriging might be bad
there might be better nonlinear and or biased methods
no properties are guaranteed when the wrong variogram is used
however typically still a good interpolation is achieved
best is not necessarily good e g
in case of no spatial dependence the kriging interpolation is only as good as the arithmetic mean
kriging provides
displaystyle sigma k
as a measure of precision
however this measure relies on the correctness of the variogram although kriging was developed originally for applications in geostatistics it is a general method of statistical interpolation and can be applied within any discipline to sampled data from random fields that satisfy the appropriate mathematical assumptions
it can be used where spatially related data has been collected in d or d and estimates of fill in data are desired in the locations spatial gaps between the actual measurements
to date kriging has been used in a variety of disciplines including the following
environmental science
hydrogeology
mining
natural resources
remote sensing
real estate appraisal
integrated circuit analysis and optimization
modelling of microwave devices
astronomy
prediction of oil production curve of shale oil wellsanother very important and rapidly growing field of application in engineering is the interpolation of data coming out as response variables of deterministic computer simulations e g
finite element method fem simulations
in this case kriging is used as a metamodeling tool i e
a black box model built over a designed set of computer experiments
in many practical engineering problems such as the design of a metal forming process a single fem simulation might be several hours or even a few days long
it is therefore more efficient to design and run a limited number of computer simulations and then use a kriging interpolator to rapidly predict the response in any other design point
kriging is therefore used very often as a so called surrogate model implemented inside optimization routines
bayes linear statistics
gaussian process
multivariate interpolation
nonparametric regression
radial basis function interpolation
space mapping
spatial dependence
variogram
gradient enhanced kriging gek
surrogate model
information field theorychil s jean paul desassis nicolas
fifty years of kriging
handbook of mathematical geosciences
cham springer international publishing
agterberg f
p geomathematics mathematical background and geo science applications elsevier scientific publishing company amsterdam
cressie n
c the origins of kriging mathematical geology v pp
krige d
g a statistical approach to some mine valuations and allied problems at the witwatersrand master s thesis of the university of witwatersrand
link r
and koch g
s experimental designs and trend surface analsysis geostatistics a colloquium plenum press new york
matheron g principles of geostatistics economic geology pp
matheron g the intrinsic random functions and their applications adv
prob pp
merriam d
editor geostatistics a colloquium plenum press new york abramowitz m and stegun i
handbook of mathematical functions dover publications new york
banerjee s carlin b
and gelfand a
hierarchical modeling and analysis for spatial data
chapman and hall crc press taylor and francis group
chiles j p
and p
delfiner geostatistics modeling spatial uncertainty wiley series in probability and statistics
clark i and harper w
v practical geostatistics ecosse north america usa
cressie n
statistics for spatial data wiley new york
david m
handbook of applied advanced geostatistical ore reserve estimation elsevier scientific publishing
deutsch c
v and journel a
gslib geostatistical software library and user s guide oxford university press new york pp
goovaerts p
geostatistics for natural resources evaluation oxford university press new york isbn
isaaks e
h and srivastava r
an introduction to applied geostatistics oxford university press new york pp
journel a
and c
huijbregts mining geostatistics academic press london
journel a
fundamentals of geostatistics in five lessons american geophysical union washington d c
press w
h teukolsky s
a vetterling w
t flannery b
section
interpolation by kriging numerical recipes the art of scientific computing rd ed new york cambridge university press isbn
also section
gaussian process regression
stein m
statistical interpolation of spatial data some theory for kriging springer new york
wackernagel h
multivariate geostatistics an introduction with applications springer berlin

