In mathematics the Leibniz formula for π named after Gottfried Leibniz states that
displaystyle -frac +frac -frac +frac -cdots =frac pi
It is also called the MadhavaLeibniz series as it is a special case of a more general series expansion for the inverse tangent function first discovered by the Indian mathematician Madhava of Sangamagrama in the th century the specific case first published by Leibniz around
The series for the inverse tangent function which is also known as Gregory's series can be given by
The Leibniz formula for π can be obtained by putting x = into this series
It also is the Dirichlet L-series of the non-principal Dirichlet character of modulus evaluated at s = and therefore the value β of the Dirichlet beta function
displaystyle beginalignedfrac pi =arctan=int frac +xdxpt=int leftsum k=n-kxk+frac -n+xn++xrightdxpt=leftsum k=nfrac -kk+right+-n+leftint frac xn++xdxrightendaligned
Considering only the integral in the last term we have
displaystyle leq int frac xn++xdxleq int xn+dx=frac n+rightarrow text as nrightarrow infty
Therefore by the squeeze theorem as n → ∞ we are left with the Leibniz series
displaystyle frac pi =sum k=infty frac -kk+
displaystyle fz=arctanz=int zfrac +zdz=sum n=infty frac -nn+zn+ z
so that it is continuous and converges uniformly the proof is complete
from within the Stolz angle so from Abel's theorem this is correct
Leibniz's formula converges extremely slowly it exhibits sublinear convergence
Calculating π to correct decimal places using direct summation of the series requires about five billion terms because k + for k × −
However the Leibniz formula can be used to calculate π to high precision hundreds of digits or more using various convergence acceleration techniques
For example the Shanks transformation Euler transform or Van Wijngaarden transformation which are general methods for alternating series can be applied effectively to the partial sums of the Leibniz series
Further combining terms pairwise gives the non-alternating series
displaystyle frac pi =sum n=infty leftfrac n+-frac n+right=sum n=infty frac n+n+
which can be evaluated to high precision from a small number of terms using Richardson extrapolation or the EulerMaclaurin formula
This series can also be transformed into an integral by means of the AbelPlana formula and evaluated using techniques for numerical integration
If the series is truncated at the right time the decimal expansion of the approximation will agree with that of π for many more digits except for isolated digits or digit groups
For example taking five million terms yields
The errors can in fact be predicted they are generated by the Euler numbers En according to the asymptotic formula
displaystyle frac pi -sum k=frac Nfrac -k-k-sim sum m=infty frac EmNm+
where N is an integer divisible by
If N is chosen to be a power of ten each term in the right sum becomes a finite decimal fraction
The formula is a special case of the Boole summation formula for alternating series providing yet another example of a convergence acceleration technique that can be applied to the Leibniz series
In Jonathan Borwein and Mark Limber used the first thousand Euler numbers to calculate π to decimal places with the Leibniz formula
The Leibniz formula can be interpreted as a Dirichlet series using the unique non-principal Dirichlet character modulo
As with other Dirichlet series this allows the infinite sum to be converted to an infinite product with one term for each prime number
Such a product is called an Euler product
displaystyle beginalignedfrac pi =leftprod pequiv pmod frac pp-rightleftprod pequiv pmod frac pp+right=frac cdot frac cdot frac cdot frac cdot frac cdot frac cdot frac cdot frac cdot frac cdots endaligned
In this product each term is a superparticular ratio each numerator is an odd prime number and each denominator is the nearest multiple of to the numerator
List of formulae involving πLeibniz Formula in C x FPU Assembly x- SSE Assembly and DEC Alpha Assembly