In statistics a QQ plot quantile-quantile plot is a probability plot which is a graphical method for comparing two probability distributions by plotting their quantiles against each other
First the set of intervals for the quantiles is chosen
A point x y on the plot corresponds to one of the quantiles of the second distribution y-coordinate plotted against the same quantile of the first distribution x-coordinate
Thus the line is a parametric curve with the parameter which is the number of the interval for the quantile
If the two distributions being compared are similar the points in the QQ plot will approximately lie on the line y = x
If the distributions are linearly related the points in the QQ plot will approximately lie on a line but not necessarily on the line y = x
QQ plots can also be used as a graphical means of estimating parameters in a location-scale family of distributions
A QQ plot is used to compare the shapes of distributions providing a graphical view of how properties such as location scale and skewness are similar or different in the two distributions
QQ plots can be used to compare collections of data or theoretical distributions
The use of QQ plots to compare two samples of data can be viewed as a non-parametric approach to comparing their underlying distributions
A QQ plot is generally a more powerful approach to do this than the common technique of comparing histograms of the two samples but requires more skill to interpret
QQ plots are commonly used to compare a data set to a theoretical model
This can provide an assessment of goodness of fit that is graphical rather than reducing to a numerical summary
QQ plots are also used to compare two theoretical distributions to each other
Since QQ plots compare distributions there is no need for the values to be observed as pairs as in a scatter plot or even for the numbers of values in the two groups being compared to be equal
The term probability plot sometimes refers specifically to a QQ plot sometimes to a more general class of plots and sometimes to the less commonly used PP plot
The probability plot correlation coefficient plot PPCC plot is a quantity derived from the idea of QQ plots which measures the agreement of a fitted distribution with observed data and which is sometimes used as a means of fitting a distribution to data
A QQ plot is a plot of the quantiles of two distributions against each other or a plot based on estimates of the quantiles
The pattern of points in the plot is used to compare the two distributions
The main step in constructing a QQ plot is calculating or estimating the quantiles to be plotted
If one or both of the axes in a QQ plot is based on a theoretical distribution with a continuous cumulative distribution function CDF all quantiles are uniquely defined and can be obtained by inverting the CDF
If a theoretical probability distribution with a discontinuous CDF is one of the two distributions being compared some of the quantiles may not be defined so an interpolated quantile may be plotted
If the QQ plot is based on data there are multiple quantile estimators in use
Rules for forming QQ plots when quantiles must be estimated or interpolated are called plotting positions
A simple case is where one has two data sets of the same size
In that case to make the QQ plot one orders each set in increasing order then pairs off and plots the corresponding values
A more complicated construction is the case where two data sets of different sizes are being compared
To construct the QQ plot in this case it is necessary to use an interpolated quantile estimate so that quantiles corresponding to the same underlying probability can be constructed
More abstractly given two cumulative probability distribution functions F and G with associated quantile functions F and G the inverse function of the CDF is the quantile function the QQ plot draws the q-th quantile of F against the q-th quantile of G for a range of values of q
Thus the QQ plot is a parametric curve indexed over with values in the real plane R
The points plotted in a QQ plot are always non-decreasing when viewed from left to right
If the two distributions being compared are identical the QQ plot follows the ° line y = x
If the two distributions agree after linearly transforming the values in one of the distributions then the QQ plot follows some line but not necessarily the line y = x
If the general trend of the QQ plot is flatter than the line y = x the distribution plotted on the horizontal axis is more dispersed than the distribution plotted on the vertical axis
Conversely if the general trend of the QQ plot is steeper than the line y = x the distribution plotted on the vertical axis is more dispersed than the distribution plotted on the horizontal axis
QQ plots are often arced or S shaped indicating that one of the distributions is more skewed than the other or that one of the distributions has heavier tails than the other
Although a QQ plot is based on quantiles in a standard QQ plot it is not possible to determine which point in the QQ plot determines a given quantile
For example it is not possible to determine the median of either of the two distributions being compared by inspecting the QQ plot
Some QQ plots indicate the deciles to make determinations such as this possible
The intercept and slope of a linear regression between the quantiles gives a measure of the relative location and relative scale of the samples
If the median of the distribution plotted on the horizontal axis is the intercept of a regression line is a measure of location and the slope is a measure of scale
The distance between medians is another measure of relative location reflected in a QQ plot
The probability plot correlation coefficient PPCC plot is the correlation coefficient between the paired sample quantiles
The closer the correlation coefficient is to one the closer the distributions are to being shifted scaled versions of each other
For distributions with a single shape parameter the probability plot correlation coefficient plot provides a method for estimating the shape parameter one simply computes the correlation coefficient for different values of the shape parameter and uses the one with the best fit just as if one were comparing distributions of different types
Another common use of QQ plots is to compare the distribution of a sample to a theoretical distribution such as the standard normal distribution N as in a normal probability plot
As in the case when comparing two samples of data one orders the data formally computes the order statistics then plots them against certain quantiles of the theoretical distribution
The choice of quantiles from a theoretical distribution can depend upon context and purpose
One choice given a sample of size n is k n for k = … n as these are the quantiles that the sampling distribution realizes
The last of these n n corresponds to the th percentile the maximum value of the theoretical distribution which is sometimes infinite
Other choices are the use of k − n or instead to space the points evenly in the uniform distribution using k n +
Many other choices have been suggested both formal and heuristic based on theory or simulations relevant in context
The following subsections discuss some of these
A narrower question is choosing a maximum estimation of a population maximum known as the German tank problem for which similar sample maximum plus a gap solutions exist most simply m + mn −
A more formal application of this uniformization of spacing occurs in maximum spacing estimation of parameters
The k n + approach equals that of plotting the points according to the probability that the last of n + randomly drawn values will not exceed the k-th smallest of the first n randomly drawn values
In using a normal probability plot the quantiles one uses are the rankits the quantile of the expected value of the order statistic of a standard normal distribution
More generally ShapiroWilk test uses the expected values of the order statistics of the given distribution the resulting plot and line yields the generalized least squares estimate for location and scale from the intercept and slope of the fitted line
Although this is not too important for the normal distribution the location and scale are estimated by the mean and standard deviation respectively it can be useful for many other distributions
However this requires calculating the expected values of the order statistic which may be difficult if the distribution is not normal
Alternatively one may use estimates of the median of the order statistics which one can compute based on estimates of the median of the order statistics of a uniform distribution and the quantile function of the distribution this was suggested by Filliben
This can be easily generated for any distribution for which the quantile function can be computed but conversely the resulting estimates of location and scale are no longer precisely the least squares estimates though these only differ significantly for n small
Several different formulas have been used or proposed as affine symmetrical plotting positions
Such formulas have the form k − a n + − a for some value of a in the range from to which gives a range between k n + and k − n −
k − n − For large sample size n there is little difference between these various expressions
The order statistic medians are the medians of the order statistics of the distribution
These can be expressed in terms of the quantile function and the order statistic medians for the continuous uniform distribution by
where Ui are the uniform order statistic medians and G is the quantile function for the desired distribution
The quantile function is the inverse of the cumulative distribution function probability that X is less than or equal to some value
That is given a probability we want the corresponding quantile of the cumulative distribution function
Filliben Filliben uses the following estimates for the uniform order statistic medians
The reason for this estimate is that the order statistic medians do not have a simple form
Probit analysis was developed by Chester Ittner Bliss in Probability plot